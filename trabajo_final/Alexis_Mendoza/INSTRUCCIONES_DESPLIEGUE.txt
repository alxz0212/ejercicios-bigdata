================================================================================
GU√çA R√ÅPIDA DE DESPLIEGUE DESDE CERO (CHEAT SHEET)
Proyecto: Big Data & "Gran Juego" (Pipeline + ML + Dashboard)
================================================================================


PRERREQUISITOS:
1. Tener Docker Desktop instalado y corriendo.
2. Tener el c√≥digo fuente descargado.
3. Abrir una terminal (PowerShell o CMD) y navegar a la carpeta del proyecto:
   > cd trabajo_final/Alexis_Mendoza
   (IMPORTANTE: Todos los comandos deben ejecutarse desde esta carpeta)

--------------------------------------------------------------------------------
PASO 0: LEVANTAR LA INFRAESTRUCTURA ÔøΩ
--------------------------------------------------------------------------------
Enciende los servidores (Jupyter, Spark Master/Worker, Postgres).
El flag '-d' lo hace en segundo plano.

Comando:
> docker-compose up -d --build

Espera a que se construya la imagen y arranque todo.
NOTA: La primera vez puede tardar entre 5 y 10 minutos (descarga de im√°genes).
Las siguientes veces ser√° casi instant√°neo.

--->*Docker debe estar abierto antes de ejecutar cualquier comando*

--------------------------------------------------------------------------------
PASO 1: PREPARACI√ìN DE DATOS (IMPORTANTE) ÔøΩ
--------------------------------------------------------------------------------
Antes de iniciar, necesitas el dataset "Quality of Government" (Time-Series).
1. Crea la carpeta donde ir√°n los datos raw.
2. Coloca el archivo 'qog_std_ts_jan26.csv' dentro.

Comando (PowerShell):
> docker exec jupyter_lab python /home/jovyan/work/src/download_data.py

--------------------------------------------------------------------------------
PASO 2: INSTALAR DEPENDENCIAS (Autom√°tico) üì¶
--------------------------------------------------------------------------------
Las dependencias (Streamlit, PySpark, etc.) ahora se instalan autom√°ticamente 
al levantar el contenedor gracias al Dockerfile y requirements.txt.
¬°Ya no necesitas ejecutar nada aqu√≠!


--------------------------------------------------------------------------------
PASO 3: EJECUTAR EL PIPELINE DE DATOS (ETL) ‚öôÔ∏è
--------------------------------------------------------------------------------
Procesa el CSV crudo y genera el archivo Parquet limpio.

Comando:
> docker exec jupyter_lab python /home/jovyan/work/src/pipeline.py

Deber√≠as ver "Proceso ETL completado con √©xito".

--------------------------------------------------------------------------------
PASO 4: ENTRENAR MODELO Y GENERAR GR√ÅFICOS (SPARK) üìä
--------------------------------------------------------------------------------
Calcula las correlaciones y entrena el Random Forest con PySpark.

Comando:
> docker exec jupyter_lab spark-submit /home/jovyan/work/src/analysis.py

Esto generar√° las im√°genes .png en la carpeta notebooks/.

--------------------------------------------------------------------------------
PASO 5: EJECUTAR AN√ÅLISIS ECONOM√âTRICO (HAUSMAN) üìâ
--------------------------------------------------------------------------------
Calcula Efectos Fijos vs Aleatorios para validar la hip√≥tesis.

Comando:
> docker exec jupyter_lab python /home/jovyan/work/src/econometric_analysis.py

Genera reporte en notebooks/hausman_results.txt.

--------------------------------------------------------------------------------
PASO 6: LANZAR LA "SUPER WEB" (DASHBOARD) üöÄ
--------------------------------------------------------------------------------
Inicia el servidor de Streamlit en segundo plano.

Comando (Versi√≥n Cl√°sica):
> docker exec -d -w /home/jovyan/work/src jupyter_lab streamlit run app_streamlit.py

Comando (Versi√≥n PRO 3D) üåü:
> docker exec -d -w /home/jovyan/work/src jupyter_lab streamlit run app_streamlit_pro.py

--------------------------------------------------------------------------------
ACCESOS üåê
--------------------------------------------------------------------------------

üîπ DASHBOARD (Streamlit):   http://localhost:8501
   (Aqu√≠ est√° tu web interactiva con el Bot IA)

üîπ JUPYTER LAB:             http://localhost:8888
   (Contrase√±a: bigdata2024 - Para ver el c√≥digo o notebooks)

üîπ SPARK MASTER:            http://localhost:8081
   (Para ver el estado del cluster)

üîπ SPARK JOB UI:            http://localhost:4040
   (‚ö†Ô∏è OJO: Solo funciona **DURANTE** la ejecuci√≥n del script. Al terminar, se cierra sola)

--------------------------------------------------------------------------------
C√ìMO APAGAR TODO üõë
--------------------------------------------------------------------------------
Cuando termines, elimina todo para limpiar tu m√°quina.

Comando:
> docker-compose down
================================================================================
C√ìMO ACTUALIZAR EN GITHUB üêô
--------------------------------------------------------------------------------
Si haces cambios en el codigo y quieres subirlos a tu repositorio:

1.  Verificar estado de archivos modificados:
    > git status

2.  Agregar todos los cambios al area de preparacion (stage):
    > git add .

3.  Guardar los cambios con un mensaje descriptivo:
    > git commit -m "Mensaje explicando tus cambios"

4.  Subir los cambios a GitHub:
    > git push origin main

5.  (Opcional) Si hay cambios en el repositorio remoto que no tienes localmente:
    > git pull origin main

================================================================================
TROUBLESHOOTING / EXTRAS üõ†Ô∏è
--------------------------------------------------------------------------------

¬øEl Dashboard no se actualiza o se queda "pegado"?
A veces Streamlit no detecta cambios en el c√≥digo. Para reiniciarlo "a la fuerza":

1. Mata el proceso actual:
> docker exec jupyter_lab pkill -f streamlit

2. In√≠cialo de nuevo en segundo plano:
> docker exec -d jupyter_lab streamlit run /home/jovyan/work/src/app_streamlit.py

¬øError: "Ports are not available" o fallo de puerto?
Esto pasa si el puerto (8080, 8081, etc.) est√° ocupado por otro programa en tu PC.

Soluci√≥n:
1. Abre el archivo `docker-compose.yml`.
2. Busca los `ports` del servicio que falla.
3. Cambia el n√∫mero de la IZQUIERDA (el de tu PC). 
   Ejemplo: Cambiar "8081:8080" a "8085:8080".
4. Vuelve a ejecutar: `docker-compose up -d`

================================================================================
--------------------------------------------------------------------------------
EJECUCI√ìN RECURRENTE (SEGUNDA VEZ EN ADELANTE) üîÑ
--------------------------------------------------------------------------------
Si ya realizaste la instalaci√≥n inicial y solo quieres volver a arrancar el proyecto:

1.  **¬øDOCKER DESKTOP ABIERTO?**: S√ç. Es obligatorio que el programa "Docker Desktop" est√© abierto y funcionando antes de tirar cualquier comando.

2.  En tu terminal (carpeta del proyecto), ejecuta SOLO estos comandos:
    
    a) Levantar servicios:
       > docker-compose up -d

    b) (Opcional) Si quieres regenerar datos/modelos (si cambiaste algo):
       > docker exec jupyter_lab python /home/jovyan/work/src/pipeline.py
       > docker exec jupyter_lab spark-submit /home/jovyan/work/src/analysis.py
       > docker exec jupyter_lab python /home/jovyan/work/src/econometric_analysis.py

    c) Lanzar la Web (Dashboard):
       > docker exec -d jupyter_lab streamlit run /home/jovyan/work/src/app_streamlit_pro.py
       (O usa 'app_streamlit.py' para la versi√≥n cl√°sica)

    d) Ir a: http://localhost:8501

--------------------------------------------------------------------------------
PASO EXTRA: VER DOCUMENTACI√ìN WEB EN LOCAL (MKDOCS) üìö
--------------------------------------------------------------------------------
Si quieres ver c√≥mo qued√≥ la p√°gina web antes de subirla a GitHub.

1. Abre otra terminal en la carpeta del proyecto.
2. Ejecuta:
   > python -m mkdocs serve

3. Accede a: http://127.0.0.1:8000
   (Tus cambios se ver√°n en tiempo real)

================================================================================
SCRIPT AUTOM√ÅTICO (EXPERIMENTAL) ü§ñ
--------------------------------------------------------------------------------
Si no quieres escribir comandos de Git, he creado un script para ti:

1.  Busca el archivo `upload_to_github.bat` en la carpeta ra√≠z.
2.  Haz doble clic sobre √©l.
3.  Te pedir√° que escribas qu√© cambios has hecho.
4.  Presiona ENTER y listo, subir√° todo solo.

¬°M√°s f√°cil imposible!
